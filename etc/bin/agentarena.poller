#!/usr/bin/env python3
"""
Script to start the Agent Arena server using uvicorn.
"""

import uvicorn
import os
import sys
from pathlib import Path

# Determine the project root directory
script_path = Path(__file__)
project_root = script_path.parent.parent.parent

# Change working directory to project root
os.chdir(project_root)

# Check for config file
config_file = os.path.join(project_root, "agent-arena-config.yaml")
if not os.path.exists(config_file):
    print(f"Cannot find the config file: {config_file}")
    sys.exit(1)

sys.path.append(os.path.abspath('./src'))
# Run the server
if __name__ == "__main__":
    print(f"Starting Agent Arena poller from {project_root}")
    uvicorn.run(
        "agentarena.scheduler:scheduler", 
        host="0.0.0.0", 
        port=8080, 
        reload=True,
        workers=1
    )